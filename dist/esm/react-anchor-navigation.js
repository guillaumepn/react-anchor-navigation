/**
 * @license react-anchor-navigation 0.1.0
 * MIT License
 * License: MIT
 */
import e,{createContext as r,useContext as t,useState as n,useEffect as c,useRef as s}from"react";var o=()=>{},a=r({sections:[],hash:"",registerSection:o,unregisterSection:o,setHash:o});function l(){return(l=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function i(e,r){if(null==e)return{};var t,n,c=function(e,r){if(null==e)return{};var t,n,c={},s=Object.keys(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||(c[t]=e[t]);return c}(e,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(c[t]=e[t])}return c}function u(r){var{children:n,className:c,activeClassName:s}=r,o=i(r,["children","className","activeClassName"]),{hash:u}=t(a),v=(c?"".concat(c," "):"")+(u===o.href?s:"");return e.createElement("a",l({},o,{className:v}),n)}function v(e){var[r,t]=n("");return c(()=>{var r=r=>{t(location.hash),r&&"hashchange"===r.type&&(e.current.blockScrollEvent=!0,setTimeout(()=>{e.current.blockScrollEvent=!1},100))};return addEventListener("hashchange",r,!1),addEventListener("popstate",r,!1),r(),()=>{removeEventListener("hashchange",r,!1),removeEventListener("popstate",r,!1)}},[]),[r,function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t(e),globalThis.history&&globalThis.location&&(!r&&"pushState"in history?history.pushState(null,e.substr(1),e):location.hash=e)}]}var h="client"===process.env.BUILD_TARGET&&(()=>{var e=!1;try{var r=()=>{},t=Object.defineProperty({},"passive",{get:()=>e=!0});addEventListener("testPassive",r,t),removeEventListener("testPassive",r,t)}catch(e){}return e})();var f=(e,r)=>{var t=0,n=e;do{t+=n.offsetTop,n=n.offsetParent}while(n&&n!==r);return t},p=h&&{capture:!1,passive:!0};function d(e,r){c(()=>{var t=function(e,r){var t=null;function n(){t||(t=setTimeout(()=>{t=null,e()},r))}return n.cancel=()=>{t&&(clearTimeout(t),t=null)},n}(()=>{var{blockScrollEvent:t,sections:n,scroller:c}=e.current;if(!t&&n.length){var s=c?c.scrollTop:window.pageYOffset||document.documentElement.scrollTop;if(f(n[0],c)>s)r("#",!1);else{var o=n.findIndex(e=>f(e,c)>s),a=n[Math.max(o-1,0)];a&&r("#".concat(a.id),!1)}}},100);return addEventListener("scroll",t,p),()=>{removeEventListener("scroll",t,p),t.cancel()}},[])}function m(r){var{children:t,getScroller:n}=r,c=s({sections:[],blockScrollEvent:!1,scroller:null});n&&(c.current.scroller=n());var[o,l]=v(c);d(c,l);return e.createElement(a.Provider,{value:{hash:o,sections:c.current.sections,setHash:l,registerSection:e=>{var{sections:r,scroller:t}=c.current;if(!r.includes(e)){var n=f(e,t),s=r.findIndex(e=>f(e,t)>n);-1===s?r.push(e):r.splice(s,0,e)}},unregisterSection:e=>{var r=c.current.sections.indexOf(e);-1!==r&&c.current.sections.splice(r,1)}}},t)}function g(r){var{children:n}=r,o=i(r,["children"]),{registerSection:u,unregisterSection:v}=t(a),h=s(null);return c(()=>(h.current&&(u(h.current),o.id===location.hash.substr(1)&&h.current.scrollIntoView()),()=>{h.current&&v(h.current)}),[]),e.createElement(e.Fragment,null,e.createElement("b",l({},o,{ref:h})),n)}export{a as AnchorContext,u as AnchorLink,m as AnchorProvider,g as AnchorSection,d as useAnchorScrollListener,v as useHash};
